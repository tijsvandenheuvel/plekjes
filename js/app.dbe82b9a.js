(function(e){function t(t){for(var n,a,l=t[0],s=t[1],c=t[2],u=0,d=[];u<l.length;u++)a=l[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&d.push(r[a][0]),r[a]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,a=1;a<o.length;a++){var l=o[a];0!==r[l]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=o[0]))}return e}var n={},a={app:0},r={app:0},i=[];function l(e){return s.p+"js/"+({about:"about"}[e]||e)+"."+{about:"a94b9267"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],o={about:1};a[e]?t.push(a[e]):0!==a[e]&&o[e]&&t.push(a[e]=new Promise((function(t,o){for(var n="css/"+({about:"about"}[e]||e)+"."+{about:"d63b3d42"}[e]+".css",r=s.p+n,i=document.getElementsByTagName("link"),l=0;l<i.length;l++){var c=i[l],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===n||u===r))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){c=d[l],u=c.getAttribute("data-href");if(u===n||u===r)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||r,i=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=n,delete a[e],p.parentNode.removeChild(p),o(i)},p.href=r;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){a[e]=0})));var n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,o){n=r[e]=[t,o]}));t.push(n[2]=i);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=l(e);var d=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(p);var o=r[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",d.name="ChunkLoadError",d.type=n,d.request=a,o[1](d)}r[e]=void 0}};var p=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var p=u;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"057d":function(e,t,o){"use strict";o("9aa6")},"41cb":function(e,t,o){"use strict";o("d3b7"),o("3ca3"),o("ddb0"),o("45fc"),o("0d03"),o("ac1f"),o("5319");var n=o("6c02"),a=o("7a23"),r={class:"home"},i={key:0},l={key:1,style:{textAlign:"left",margin:"10px"}},s={key:2,style:{textAlign:"left",margin:"10px"}},c={key:2};function u(e,t,o,n,u,d){var p=this,f=Object(a["A"])("SideMenu"),h=Object(a["A"])("LeafletMap");return Object(a["t"])(),Object(a["f"])("div",r,[this.$store.state.showMenu?(Object(a["t"])(),Object(a["f"])("div",i,[""!=this.$store.state.userEmail?(Object(a["t"])(),Object(a["d"])(f,{key:0})):this.$store.state.userIsAuthenticated?(Object(a["t"])(),Object(a["f"])("div",s," Loading... ")):(Object(a["t"])(),Object(a["f"])("div",l,[Object(a["g"])("button",{class:"btn",onClick:t[0]||(t[0]=function(e){return p.$store.dispatch("auth0Login")})},"Log in")]))])):Object(a["e"])("",!0),this.$store.state.showMap?(Object(a["t"])(),Object(a["f"])("div",{key:this.$store.state.reloadMap},[Object(a["j"])(h)])):(Object(a["t"])(),Object(a["f"])("div",c))])}var d={key:0,id:"mapContainer",style:{width:"75%",left:"25%"}},p={key:1,id:"mapContainer"};function f(e,t,o,n,r,i){return this.$store.state.showMenu?(Object(a["t"])(),Object(a["f"])("div",d)):(Object(a["t"])(),Object(a["f"])("div",p))}o("d81d"),o("b0c0"),o("4160"),o("159b");var h,m=o("e11e"),b=o.n(m),g=(o("20d6"),o("6cc5"),o("5fbf"),o("ba5f"));delete b.a.Icon.Default.prototype._getIconUrl,b.a.Icon.Default.mergeOptions({iconRetinaUrl:o("584d"),iconUrl:o("6397"),shadowUrl:o("e2b9")});var k={data:function(){return{osm_layer:b.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),layercontrol:b.a.control.layers(),fullScreenMap:!1,polygonMarkerOptions:{radius:2,fillColor:"green",color:"green",weight:2,opacity:.5,fillOpacity:.2},pointMarkerOptions:{radius:3,fillColor:"red",color:"red",weight:3,opacity:1,fillOpacity:.2},drawControl:null}},methods:{setupLeafletMap:function(){h=b.a.map("mapContainer",{center:[51.11,4.46],crs:b.a.CRS.EPSG3857,zoom:11,zoomControl:!0,preferCanvas:!1}),this.osm_layer.addTo(h),b.a.control.scale().addTo(h),this.layercontrol.addTo(h),this.layercontrol.addBaseLayer(this.osm_layer,"OSM layer")},addToolTip:function(e,t){e.properties&&e.properties.name&&t.bindTooltip(e.properties.name)},displayFeatures:function(e){var t,o=this;t=this.$store.state.edittingPlekollection?this.drawnItems:b.a.featureGroup().addTo(h),e.features.forEach((function(e){switch(e.geometry.type){case"Point":o.$store.state.edittingPlekollection?b.a.geoJSON(e,{onEachFeature:o.addToolTip}).addTo(t):b.a.geoJSON(e,{pointToLayer:function(e,t){return b.a.circleMarker(t,o.pointMarkerOptions)},onEachFeature:o.addToolTip}).addTo(t);break;case"Polygon":case"MultiPolygon":b.a.geoJSON(e,{style:o.polygonMarkerOptions,onEachFeature:o.addToolTip}).addTo(t);break;default:b.a.geoJSON(e,{onEachFeature:o.addToolTip}).addTo(t)}})),this.$store.state.edittingPlekollection||this.layercontrol.addOverlay(t,e.props.name)},displayFeatureCollections:function(){var e=this;h.eachLayer((function(t){t._url||(h.removeLayer(t),e.layercontrol.removeLayer(t))})),this.$store.state.featureCollections.forEach((function(t){e.displayFeatures(t)}))},addDrawControl:function(e){var t=this;this.drawControl||(this.drawnItems=(new b.a.FeatureGroup).addTo(h),this.layercontrol.addOverlay(this.drawnItems,e),this.drawControl=new b.a.Control.Draw({edit:{featureGroup:this.drawnItems,edit:!1},draw:{polygon:!0,polyline:!0,rectangle:!1,circlemarker:!1,circle:!1,marker:!0}}),this.drawControl.addTo(h)),h.on(b.a.Draw.Event.CREATED,(function(e){var o=e.layer;o.properties={};var n=o.feature=o.feature||{};n.type="Feature",n.properties=n.properties||{};var a=prompt("Name Plekje"," ");null!=a&&" "!=a&&(n.properties["name"]=a,o.bindTooltip(n.properties["name"]),t.drawnItems.addLayer(o),t.$store.state.edittingPlekollection&&t.$store.state.featureCollectionToEdit.features.push(o.toGeoJSON()))})),h.on("draw:deleted",(function(e){console.log(e)}))}},mounted:function(){var e=this;this.setupLeafletMap(),this.$store.state.edittingPlekollection&&(this.addDrawControl(this.$store.state.featureCollectionToEdit.name),this.displayFeatures(this.$store.state.featureCollectionToEdit)),this.$store.state.creatingPlekollection&&this.addDrawControl("new plekollection"),this.emitter.all.clear(),this.emitter.on("updateFeatureCollectionsShownOnMap",(function(){e.displayFeatureCollections()})),this.emitter.on("saveNewPlekollection",(function(t){var o=e.drawnItems.toGeoJSON();0!=o.features.length?(g.launchCreatePlekollectionFlow(o,t),e.$store.state.creatingPlekollection=!1,e.$store.commit("reloadMap")):alert("Create plekjes to save first")})),this.emitter.on("saveEdittedPlekollection",(function(){var t=e.drawnItems.toGeoJSON();0!=t.features.length?g.launchEditPlekollectionFlow(t):alert("Create plekjes to save first")}))},beforeUnmount:function(){h&&h.remove()}},O=(o("057d"),o("6b0d")),j=o.n(O);const v=j()(k,[["render",f],["__scopeId","data-v-7fc66ff1"]]);var y=v,C=(o("caad"),o("2532"),{class:"menu"}),P=Object(a["g"])("div",{class:"card"},[Object(a["g"])("h1",null,"Plekjes"),Object(a["g"])("p",null,"V0.6 Pre-alpha")],-1),w={key:0},$={class:"card"},S=Object(a["g"])("p",null,"new Plekollection",-1),T=Object(a["i"])("name: "),_=Object(a["g"])("br",null,null,-1),E=Object(a["g"])("br",null,null,-1),M=Object(a["g"])("br",null,null,-1),N=Object(a["g"])("br",null,null,-1),I={key:1},A={class:"card"},D=Object(a["g"])("h2",null,"My plekollections",-1),F={key:0},J={class:"list"},L=["onClick"],x=["onClick"],U={key:1},G=Object(a["g"])("br",null,null,-1),H={key:0,class:"card"},q=Object(a["i"])(" Â  "),z=Object(a["g"])("br",null,null,-1),B=Object(a["g"])("br",null,null,-1),R={class:"list"},V=["onClick"],Q={class:"list"},K=Object(a["g"])("br",null,null,-1),W={key:2};function X(e,t,o,n,r,i){var l=this;return Object(a["t"])(),Object(a["f"])("div",C,[P,this.$store.state.creatingPlekollection?(Object(a["t"])(),Object(a["f"])("div",w,[Object(a["g"])("div",$,[S,Object(a["g"])("span",null,[T,Object(a["H"])(Object(a["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return r.new_plekollection_name=e})},null,512),[[a["E"],r.new_plekollection_name]])]),_,E,Object(a["g"])("button",{class:"btn",onClick:t[1]||(t[1]=function(e){return i.saveNewPlekollection()})}," save "),M,N])])):Object(a["e"])("",!0),this.$store.state.userData?(Object(a["t"])(),Object(a["f"])("div",I,[Object(a["g"])("div",A,[D,this.$store.state.userData.my_plekollections.length>0?(Object(a["t"])(),Object(a["f"])("div",F,[(Object(a["t"])(!0),Object(a["f"])(a["a"],null,Object(a["z"])(this.$store.state.userData.my_plekollections,(function(e,t){return Object(a["t"])(),Object(a["f"])("div",J,[Object(a["g"])("div",{onClick:function(e){return i.selectPlekollection(t)},class:Object(a["p"])({selected:t==r.selected_i})},[Object(a["i"])(Object(a["C"])(e.name)+" ",1),l.$store.state.featureCollections.map((function(e){return e.props.name})).includes(e.name)?(Object(a["t"])(),Object(a["f"])("button",{key:0,onClick:function(o){return i.removeFromMap(e,t)}}," x ",8,x)):Object(a["e"])("",!0)],10,L)])})),256))])):this.$store.state.creatingPlekollection?Object(a["e"])("",!0):(Object(a["t"])(),Object(a["f"])("div",U,[Object(a["g"])("button",{class:"btn",onClick:t[2]||(t[2]=function(e){l.$store.state.creatingPlekollection=!0,l.$store.commit("reloadMap")})}," New plekollection ")])),G]),this.$store.state.selectedPlekollection?(Object(a["t"])(),Object(a["f"])("div",H,[Object(a["g"])("h2",null,Object(a["C"])(this.$store.state.selectedPlekollection.name),1),Object(a["g"])("button",{class:"btn",onClick:t[3]||(t[3]=function(e){return i.showSelectedPlekollectionOnMap()})}," Show on map "),q,this.$store.state.edittingPlekollection&&this.$store.state.featureCollectionToEdit&&this.$store.state.selectedPlekollection.name==this.$store.state.featureCollectionToEdit.props.name?(Object(a["t"])(),Object(a["f"])("button",{key:0,class:"btn",onClick:t[4]||(t[4]=function(e){return i.SaveEdittedPlekollection()})}," Save ")):(Object(a["t"])(),Object(a["f"])("button",{key:1,class:"btn",onClick:t[5]||(t[5]=function(e){return i.editSelectedPlekollection()})}," Edit ")),z,B,this.$store.state.edittingPlekollection&&this.$store.state.featureCollectionToEdit&&this.$store.state.selectedPlekollection.name==this.$store.state.featureCollectionToEdit.props.name?(Object(a["t"])(!0),Object(a["f"])(a["a"],{key:2},Object(a["z"])(this.$store.state.featureCollectionToEdit.features,(function(e){return Object(a["t"])(),Object(a["f"])("div",R,[Object(a["g"])("div",null,[Object(a["i"])(Object(a["C"])(e.properties.name)+" ",1),l.$store.state.edittingPlekollection?(Object(a["t"])(),Object(a["f"])("button",{key:0,onClick:function(t){return i.removeFromFeatureCollectionToEdit(e)}}," - ",8,V)):Object(a["e"])("",!0)])])})),256)):(Object(a["t"])(!0),Object(a["f"])(a["a"],{key:3},Object(a["z"])(this.$store.state.selectedPlekollection.plekjes,(function(e){return Object(a["t"])(),Object(a["f"])("div",Q,Object(a["C"])(e.name),1)})),256)),K])):Object(a["e"])("",!0)])):(Object(a["t"])(),Object(a["f"])("div",W,"Loading..."))])}o("99af"),o("4de4");var Y=o("ba5f"),Z={data:function(){return{selected_i:null,new_plekollection_name:null,plekollection_to_edit:{name:null}}},methods:{selectPlekollection:function(e){this.selected_i=e;var t=this.$store.state.userData.my_plekollections[e]._id;Y.getSelectedPlekollectionData(t)},saveNewPlekollection:function(){!this.new_plekollection_name|" "==this.new_plekollection_name?alert("please enter a plekollection name"):this.emitter.emit("saveNewPlekollection",this.new_plekollection_name)},showSelectedPlekollectionOnMap:function(){var e=this;this.$store.state.edittingPlekollection&&(this.$store.state.edittingPlekollection=!1,this.$store.commit("reloadMap")),this.$store.state.showMap||(this.$store.state.showMap=!0),Y.setFeatureCollectionToShow((function(){e.emitter.emit("updateFeatureCollectionsShownOnMap")}))},removeFromMap:function(e){this.$store.commit("filterFeatureCollections",e.name),this.emitter.emit("updateFeatureCollectionsShownOnMap")},editSelectedPlekollection:function(){var e=this;this.$store.state.creatingPlekollection=!1,this.$store.state.edittingPlekollection=!0,this.$store.state.featureCollections=[],Y.setFeatureCollectionToEdit((function(){e.$store.commit("reloadMap")}))},removeFromFeatureCollectionToEdit:function(e){confirm('Delete "'.concat(e.properties.name,'" from "').concat(this.$store.state.featureCollectionToEdit.props.name,'"?'))?(console.log("deleting"),this.$store.state.featureCollectionToEdit.features=this.$store.state.featureCollectionToEdit.features.filter((function(t){return t.properties.name!=e.properties.name})),this.$store.commit("reloadMap")):console.log("canceled")},SaveEdittedPlekollection:function(){this.emitter.emit("saveEdittedPlekollection")}},mounted:function(){this.$store.state.userData||this.$store.dispatch("setUserData")}};o("62d3");const ee=j()(Z,[["render",X]]);var te=ee,oe={name:"Home",components:{LeafletMap:y,SideMenu:te},data:function(){return{}},beforeCreate:function(){""==this.$store.state.userEmail&&this.$store.dispatch("auth0getUserEmail"),this.$store.state.userIsAuthenticated||(this.$store.state.showMenu=!1)}};const ne=j()(oe,[["render",u]]);var ae=ne,re=o("c0d6"),ie=[{path:"/",name:"Home",component:ae},{path:"/auth0callback",component:ae},{path:"/about",name:"About",component:function(){return o.e("about").then(o.bind(null,"f820"))}},{path:"/profile",name:"Profile",component:function(){return o.e("about").then(o.bind(null,"c66d"))},meta:{requiresAuth:!0}}],le=Object(n["a"])({history:Object(n["b"])("/"),routes:ie});le.beforeEach((function(e,t,o){e.matched.some((function(e){return"/auth0callback"==e.path}))&&re["a"].dispatch("auth0HandleAuthentication");var n=!1;if(localStorage.getItem("access_token")&&localStorage.getItem("id_token")&&localStorage.getItem("expires_at")){var a=JSON.parse(localStorage.getItem("expires_at"));n=(new Date).getTime()<a}re["a"].commit("setUserIsAuthenticated",n),e.matched.some((function(e){return e.meta.requiresAuth}))?n?(re["a"].commit("setUserIsAuthenticated",!0),o()):le.replace("/"):o()}));t["a"]=le},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("7a23"),a=Object(n["g"])("br",null,null,-1),r=Object(n["g"])("br",null,null,-1);function i(e,t,o,i,l,s){var c=Object(n["A"])("NavBar"),u=Object(n["A"])("router-view");return Object(n["t"])(),Object(n["f"])(n["a"],null,[Object(n["j"])(c),a,r,Object(n["j"])(u)],64)}o("b0c0");var l={class:"nav"},s=Object(n["i"])("Home"),c={key:0,class:"buttongroup"},u=Object(n["i"])("About"),d=Object(n["i"])("Profile"),p={class:"log"};function f(e,t,o,a,r,i){var f=Object(n["A"])("router-link");return Object(n["t"])(),Object(n["f"])("div",l,[Object(n["j"])(f,{to:"/"},{default:Object(n["G"])((function(){return[s]})),_:1}),"Home"==this.$route.name?(Object(n["t"])(),Object(n["f"])("span",c,[Object(n["g"])("a",{class:Object(n["p"])(["button",{active:this.$store.state.showMap}]),onClick:t[0]||(t[0]=function(e){return i.toggleMap()})}," Map ",2),Object(n["g"])("a",{class:Object(n["p"])(["button",{active:this.$store.state.showMenu}]),onClick:t[1]||(t[1]=function(e){return i.toggleMenu()})}," Menu ",2),this.$store.state.userIsAuthenticated?(Object(n["t"])(),Object(n["f"])("a",{key:0,class:Object(n["p"])(["button",{active:this.$store.state.creatingPlekollection}]),onClick:t[2]||(t[2]=function(e){return i.initCreatePlekollection()})}," New ",2)):Object(n["e"])("",!0)])):Object(n["e"])("",!0),Object(n["j"])(f,{to:"/about"},{default:Object(n["G"])((function(){return[u]})),_:1}),this.$store.state.userIsAuthenticated?(Object(n["t"])(),Object(n["d"])(f,{key:1,to:"/profile"},{default:Object(n["G"])((function(){return[d]})),_:1})):Object(n["e"])("",!0),Object(n["g"])("span",p,[this.$store.state.userIsAuthenticated?Object(n["e"])("",!0):(Object(n["t"])(),Object(n["f"])("a",{key:0,onClick:t[3]||(t[3]=function(e){return i.login()})},"Login")),this.$store.state.userIsAuthenticated?(Object(n["t"])(),Object(n["f"])("a",{key:1,onClick:t[4]||(t[4]=function(e){return i.logout()})},"Logout")):Object(n["e"])("",!0)])])}var h={data:function(){return{}},methods:{login:function(){this.$store.dispatch("auth0Login")},logout:function(){this.$store.dispatch("auth0Logout")},toggleMap:function(){this.$store.state.creatingPlekollection||(this.$store.state.showMap=!this.$store.state.showMap)},toggleMenu:function(){this.$store.state.edittingPlekollection=!1,this.$store.state.showMenu=!this.$store.state.showMenu,this.$store.commit("reloadMap")},initCreatePlekollection:function(){this.$store.state.edittingPlekollection=!1,this.$store.state.creatingPlekollection=!this.$store.state.creatingPlekollection,this.$store.state.creatingPlekollection&&(this.$store.state.showMenu=!0),this.$store.state.featureCollections=[],this.$store.commit("reloadMap")}}},m=(o("56f1"),o("6b0d")),b=o.n(m);const g=b()(h,[["render",f]]);var k=g,O={components:{NavBar:k},data:function(){return{}}};o("84b8");const j=b()(O,[["render",i]]);var v=j,y=o("41cb"),C=o("c0d6"),P=o("1344"),w=Object(P["a"])(),$=Object(n["c"])(v);$.config.globalProperties.emitter=w,$.use(C["a"]).use(y["a"]).mount("#app")},"56f1":function(e,t,o){"use strict";o("d797")},"62d3":function(e,t,o){"use strict";o("c594")},"84b8":function(e,t,o){"use strict";o("e5f6")},"9aa6":function(e,t,o){},ba5f:function(e,t,o){"use strict";o.r(t),o.d(t,"apiCall",(function(){return a})),o.d(t,"getSelectedPlekollectionData",(function(){return r})),o.d(t,"setFeatureCollectionToShow",(function(){return i})),o.d(t,"setFeatureCollectionToEdit",(function(){return l})),o.d(t,"launchCreatePlekollectionFlow",(function(){return d})),o.d(t,"launchEditPlekollectionFlow",(function(){return m}));o("caad"),o("2532"),o("d81d"),o("b0c0"),o("4160"),o("d3b7"),o("159b"),o("e9c4"),o("4de4"),o("99af"),o("a15b"),o("4e82"),o("accc"),o("0d03");var n=o("c0d6");function a(e,t,o,n){var a=new XMLHttpRequest;a.open(e,t,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer ".concat(localStorage.getItem("access_token"))),a.send(o),a.onreadystatechange=function(){4==a.readyState&&"200"==a.status&&n(a.responseText)}}function r(e){a("GET","https://plekjes-server.herokuapp.com/plekollections/get_one/"+e,null,(function(e){if(e){var t=JSON.parse(e);n["a"].state.selectedPlekollection=t}}))}function i(e){n["a"].state.featureCollections.map((function(e){return e.props.name})).includes(n["a"].state.selectedPlekollection.name)||s((function(t){n["a"].state.featureCollections.push(t),e()}))}function l(e){s((function(t){n["a"].state.featureCollectionToEdit=t,e()}))}var s=function(e){var t=n["a"].state.selectedPlekollection.plekjes.map((function(e){return e._id}));u(t,(function(t){e(c(t))}))},c=function(e){var t={type:"FeatureCollection",props:{name:n["a"].state.selectedPlekollection.name,id:n["a"].state.selectedPlekollection._id},features:[]};return e.forEach((function(e){t.features.push({type:"Feature",properties:{name:e.name,id:e._id},geometry:e.geometry})})),t},u=function(e,t){var o=JSON.stringify({ids:e});a("POST","https://plekjes-server.herokuapp.com/plekjes/get_multiple/",o,(function(e){var o=JSON.parse(e);t(o)}))};function d(e,t){p(e,t)}var p=function(e,t){for(var o=[],r=0;r<e.features.length;r++)o.push({name:e.features[r].properties.name,tags:[t],founder:n["a"].state.userData.username,geometry:e.features[r].geometry});a("POST","https://plekjes-server.herokuapp.com/plekjes/add_multiple",JSON.stringify(o),(function(e){f(JSON.parse(e),t)}))},f=function(e,t){var o={name:t,collector:n["a"].state.userData.username,plekjes:e};a("POST","https://plekjes-server.herokuapp.com/plekollections/new",JSON.stringify(o),(function(t){h(JSON.parse(t),e)}))},h=function(e,t,o){var r=JSON.stringify({email:n["a"].state.userEmail});a("POST","https://plekjes-server.herokuapp.com/users/get_one",r,(function(r){var i=JSON.parse(r);e&&i.my_plekollections.push({name:e.name,_id:e._id});var l=o.map((function(e){return e._id}));i.my_plekjes=i.my_plekjes.filter((function(e){return!l.includes(e._id)})),t&&(i.my_plekjes=i.my_plekjes.concat(t)),a("PUT","https://plekjes-server.herokuapp.com/users/update/"+i._id,JSON.stringify(i),(function(e){n["a"].dispatch("setUserData")}))}))};function m(e){var t=[];n["a"].state.featureCollectionToEdit.features.forEach((function(e){e.properties.id||t.push(e)})),t.length>0?b(t,(function(e){k(e)})):k()}var b=function(e,t){for(var o=[],r=0;r<e.length;r++)o.push({name:e[r].properties.name,geometry:e[r].geometry,tags:[n["a"].state.featureCollectionToEdit.name],founder:n["a"].state.userData.username});a("POST","https://plekjes-server.herokuapp.com/plekjes/add_multiple",JSON.stringify(o),(function(e){t(JSON.parse(e))}))},g=function(e){a("DELETE","https://plekjes-server.herokuapp.com/plekjes/delete_multiple",JSON.stringify({ids:e}),(function(e){}))},k=function(e){a("GET","https://plekjes-server.herokuapp.com/plekollections/get_one/"+n["a"].state.featureCollectionToEdit.props.id,null,(function(t){if(t){var o=JSON.parse(t),i=o.plekjes.map((function(e){return e.name})),l=n["a"].state.featureCollectionToEdit.features.map((function(e){return e.properties.name}));if(i.sort().join(",")===l.sort().join(","))n["a"].state.edittingPlekollection=!1,n["a"].commit("reloadMap");else{var s=n["a"].state.featureCollectionToEdit.features.map((function(e){return e.properties.id})).filter((function(e){return e})),c=[],u=[];o.plekjes.forEach((function(e){s.includes(e._id)?c.push(e):u.push(e)})),o.plekjes=c,g(u.map((function(e){return e._id}))),e&&(o.plekjes=o.plekjes.concat(e)),o.updatedAt=(new Date).toISOString(),a("PUT","https://plekjes-server.herokuapp.com/plekollections/update/"+n["a"].state.featureCollectionToEdit.props.id,JSON.stringify(o),(function(t){r(n["a"].state.featureCollectionToEdit.props.id),h(null,e,u),n["a"].state.edittingPlekollection=!1,n["a"].commit("reloadMap")}))}}}))}},c0d6:function(e,t,o){"use strict";o("4de4"),o("d3b7"),o("b0c0"),o("e9c4"),o("0d03"),o("ac1f"),o("5319");var n=o("5502"),a=o("b0af"),r=o("41cb"),i=o("ba5f");t["a"]=Object(n["a"])({state:{auth0:new a["a"].WebAuth({domain:"tijs-app.eu.auth0.com",clientID:"GSTtuqSVd4zA7NvQ8qeVszNDDMhJq0Hi",redirectUri:"https://tijsvandenheuvel.github.io/plekjes/auth0callback",responseType:"token id_token",scope:"openid profile email",audience:"https://plekjes-api.be"}),userEmail:"",userData:null,userToBeCreated:!1,userIsAuthenticated:!1,reloadMap:!1,showMap:!0,showMenu:!0,creatingPlekollection:!1,edittingPlekollection:!1,featureCollectionToEdit:null,featureCollections:[],selectedPlekollection:null},mutations:{setUserIsAuthenticated:function(e,t){e.userIsAuthenticated=t},reloadMap:function(e){e.reloadMap=!e.reloadMap},filterFeatureCollections:function(e,t){e.featureCollections=e.featureCollections.filter((function(e){return e.props.name!=t}))}},actions:{auth0Login:function(e){e.state.auth0.authorize()},auth0HandleAuthentication:function(e){e.state.auth0.parseHash((function(t,o){if(o&&o.accessToken&&o.idToken){var n=JSON.stringify((new Date).getTime()+1e3*o.expiresIn);localStorage.setItem("access_token",o.accessToken),localStorage.setItem("id_token",o.idToken),localStorage.setItem("expires_at",n),e.dispatch("auth0getUserEmail"),r["a"].replace("/profile"),t&&(alert("login failed"),r["a"].replace("/"),console.log(t))}}))},auth0getUserEmail:function(e){localStorage.getItem("access_token")&&e.state.auth0.client.userInfo(localStorage.getItem("access_token"),(function(t,o){o&&(e.state.userEmail=o.email)}))},auth0Logout:function(e){localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),window.location.href="https://tijs-app.eu.auth0.com/v2/logout?returnTo=https://tijsvandenheuvel.github.io/plekjes&client_id=GSTtuqSVd4zA7NvQ8qeVszNDDMhJq0Hi"},setUserData:function(e,t){var o=JSON.stringify({email:e.state.userEmail});i.apiCall("POST","https://plekjes-server.herokuapp.com/users/get_one",o,(function(t){var o=JSON.parse(t);o?e.state.userData=o:"Profile"==r["a"].currentRoute.value.name&&(e.state.userToBeCreated=!0)}))}},modules:{}})},c594:function(e,t,o){},d797:function(e,t,o){},e5f6:function(e,t,o){}});
//# sourceMappingURL=app.dbe82b9a.js.map