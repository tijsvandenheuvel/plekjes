(function(e){function t(t){for(var n,a,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,a=1;a<o.length;a++){var s=o[a];0!==r[s]&&(n=!1)}n&&(i.splice(t--,1),e=l(l.s=o[0]))}return e}var n={},a={app:0},r={app:0},i=[];function s(e){return l.p+"js/"+({about:"about"}[e]||e)+"."+{about:"fa03bbf1"}[e]+".js"}function l(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.e=function(e){var t=[],o={about:1};a[e]?t.push(a[e]):0!==a[e]&&o[e]&&t.push(a[e]=new Promise((function(t,o){for(var n="css/"+({about:"about"}[e]||e)+"."+{about:"78ca077b"}[e]+".css",r=l.p+n,i=document.getElementsByTagName("link"),s=0;s<i.length;s++){var c=i[s],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===n||u===r))return t()}var p=document.getElementsByTagName("style");for(s=0;s<p.length;s++){c=p[s],u=c.getAttribute("data-href");if(u===n||u===r)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||r,i=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=n,delete a[e],d.parentNode.removeChild(d),o(i)},d.href=r;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){a[e]=0})));var n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,o){n=r[e]=[t,o]}));t.push(n[2]=i);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=s(e);var p=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(d);var o=r[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",p.name="ChunkLoadError",p.type=n,p.request=a,o[1](p)}r[e]=void 0}};var d=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=n,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(o,n,function(t){return e[t]}.bind(null,n));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var p=0;p<c.length;p++)t(c[p]);var d=u;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"4d57":function(e,t,o){"use strict";o("5110")},5110:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("7a23"),a={id:"main"};function r(e,t,o,r,i,s){var l=Object(n["z"])("router-view"),c=Object(n["z"])("Nav");return Object(n["s"])(),Object(n["f"])(n["a"],null,[Object(n["g"])("div",a,[Object(n["j"])(l)]),Object(n["j"])(c,{id:"nav"})],64)}var i={class:"nav"},s=Object(n["i"])("I"),l=Object(n["i"])("O"),c=Object(n["i"])("E");function u(e,t,o,a,r,u){var p=Object(n["z"])("router-link");return Object(n["s"])(),Object(n["f"])("div",i,[Object(n["j"])(p,{to:"/intern"},{default:Object(n["F"])((function(){return[s]})),_:1}),Object(n["j"])(p,{to:"/"},{default:Object(n["F"])((function(){return[l]})),_:1}),Object(n["j"])(p,{to:"/extern"},{default:Object(n["F"])((function(){return[c]})),_:1})])}var p={},d=(o("4d57"),o("6b0d")),f=o.n(d);const h=f()(p,[["render",u]]);var m=h,g={name:"App",components:{Nav:m},data:function(){return{}}};o("8c74");const k=f()(g,[["render",r]]);var v=k,y=o("da6f"),b=o("e370");Object(n["c"])(v).use(y["a"]).use(b["a"]).mount("#app")},"58f2":function(e,t,o){},"658b":function(e,t,o){"use strict";o("a463")},"7c15":function(e,t,o){"use strict";o.r(t),o.d(t,"setUserData",(function(){return i})),o.d(t,"setSelectedPlekollection",(function(){return s})),o.d(t,"setFeatureCollectionToEdit",(function(){return l})),o.d(t,"setFeatureCollectionToMap",(function(){return c})),o.d(t,"createPlekollectionFlow",(function(){return u})),o.d(t,"saveCreatedPlekollection",(function(){return p})),o.d(t,"editPlekollectionFlow",(function(){return d})),o.d(t,"checkUserNameAvailability",(function(){return f}));o("e9c4"),o("ac1f"),o("5319"),o("caad"),o("2532"),o("d81d"),o("b0c0"),o("4160"),o("d3b7"),o("159b"),o("4de4"),o("99af"),o("a15b"),o("4e82"),o("accc"),o("0d03");var n=o("da6f"),a=o("e370"),r=function(e,t,o,n){var a=new XMLHttpRequest;a.open(e,t,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer ".concat(localStorage.getItem("access_token"))),a.send(o),a.onreadystatechange=function(){4==a.readyState&&"200"==a.status&&n(a.responseText)}};function i(){var e=JSON.stringify({email:n["a"].state.userEmail});r("POST","https://plekjes-server.herokuapp.com/users/get_one",e,(function(e){var t=JSON.parse(e);t?n["a"].state.userData=t:n["a"].state.userToBeCreated=!0}))}function s(e,t){C(e,(function(e){n["a"].state.selectedPlekollection=e,t()}))}function l(){m((function(e){n["a"].state.featureCollectionToEdit=e,a["a"].replace("/")}))}function c(e){n["a"].state.featureCollections.map((function(e){return e.props.name})).includes(n["a"].state.selectedPlekollection.name)?a["a"].replace("/"):m((function(t){n["a"].state.featureCollections.push(t),e()}))}function u(e,t){v(e.features,t,(function(e){y(e,t)}))}function p(e){if(n["a"].state.creatingPlekollection=!1,n["a"].state.featureCollectionToCreate.features.length>0){var t=prompt("Name Plekollection"," ");v(n["a"].state.featureCollectionToCreate.features,t,(function(o){y(o,t),e(!0)}))}else e(!1)}function d(e){n["a"].state.editingPlekollection=!1;var t=[];n["a"].state.featureCollectionToEdit.features.forEach((function(e){e.properties.id||t.push(e)})),t.length>0?v(t,n["a"].state.featureCollectionToEdit.props.name,(function(t){O(t,(function(){e()}))})):O(null,(function(){e()}))}function f(e,t){var o=JSON.stringify({username:e});r("POST","https://plekjes-server.herokuapp.com/users/name_check",o,(function(o){var n="true"===o;n&&h(e),t(n)}))}var h=function(e){var t={email:n["a"].state.userEmail,username:e,my_plekjes:[],my_plekollections:[]};r("POST","https://plekjes-server.herokuapp.com/users/new",JSON.stringify(t),(function(e){n["a"].state.userToBeCreated=!1,i()}))},m=function(e){var t=n["a"].state.selectedPlekollection.plekjes.map((function(e){return e._id}));g(t,(function(t){e(k(t))}))},g=function(e,t){var o=JSON.stringify({ids:e});r("POST","https://plekjes-server.herokuapp.com/plekjes/get_multiple/",o,(function(e){t(JSON.parse(e))}))},k=function(e){var t={type:"FeatureCollection",props:{name:n["a"].state.selectedPlekollection.name,id:n["a"].state.selectedPlekollection._id},features:[]};return e.forEach((function(e){t.features.push({type:"Feature",properties:{name:e.name,id:e._id},geometry:e.geometry})})),t},v=function(e,t,o){for(var a=[],i=0;i<e.length;i++)a.push({name:e[i].properties.name,tags:[t],founder:n["a"].state.userData.username,geometry:e[i].geometry});r("POST","https://plekjes-server.herokuapp.com/plekjes/add_multiple",JSON.stringify(a),(function(e){o(JSON.parse(e))}))},y=function(e,t){var o={name:t,collector:n["a"].state.userData.username,plekjes:e};r("POST","https://plekjes-server.herokuapp.com/plekollections/new",JSON.stringify(o),(function(t){b(JSON.parse(t),e)}))},b=function(e,t,o){var a=JSON.stringify({email:n["a"].state.userEmail});r("POST","https://plekjes-server.herokuapp.com/users/get_one",a,(function(n){var a=JSON.parse(n);if(e&&a.my_plekollections.push({name:e.name,_id:e._id}),o){var s=o.map((function(e){return e._id}));a.my_plekjes=a.my_plekjes.filter((function(e){return!s.includes(e._id)}))}t&&(a.my_plekjes=a.my_plekjes.concat(t)),r("PUT","https://plekjes-server.herokuapp.com/users/update/"+a._id,JSON.stringify(a),(function(e){i()}))}))},O=function(e,t){C(n["a"].state.featureCollectionToEdit.props.id,(function(o){var a=o.plekjes.map((function(e){return e.name})),r=n["a"].state.featureCollectionToEdit.features.map((function(e){return e.properties.name}));if(a.sort().join(",")===r.sort().join(","))n["a"].state.editingPlekollection=!1;else{var i=n["a"].state.featureCollectionToEdit.features.map((function(e){return e.properties.id})).filter((function(e){return e})),l=[],u=[];o.plekjes.forEach((function(e){i.includes(e._id)?l.push(e):u.push(e)})),o.plekjes=l,T(u.map((function(e){return e._id}))),e&&(o.plekjes=o.plekjes.concat(e)),o.updatedAt=(new Date).toISOString(),j(n["a"].state.featureCollectionToEdit.props.id,o,(function(){b(null,e,u),n["a"].state.editingPlekollection=!1,s(n["a"].state.featureCollectionToEdit.props.id,(function(){c((function(){t()}))}))}))}}))},j=function(e,t,o){r("PUT","https://plekjes-server.herokuapp.com/plekollections/update/"+e,JSON.stringify(t),(function(e){o()}))},T=function(e){r("DELETE","https://plekjes-server.herokuapp.com/plekjes/delete_multiple",JSON.stringify({ids:e}),(function(e){}))},C=function(e,t){r("GET","https://plekjes-server.herokuapp.com/plekollections/get_one/"+e,null,(function(e){e&&(t(JSON.parse(e)),n["a"].state.selectedPlekollection=JSON.parse(e))}))}},"8c74":function(e,t,o){"use strict";o("58f2")},a463:function(e,t,o){},da6f:function(e,t,o){"use strict";o("4de4"),o("d3b7"),o("b0c0"),o("e9c4"),o("0d03"),o("ac1f"),o("5319");var n=o("5502"),a=o("b0af"),r=o("e370");t["a"]=Object(n["a"])({state:{auth0:new a["a"].WebAuth({domain:"tijs-app.eu.auth0.com",clientID:"GSTtuqSVd4zA7NvQ8qeVszNDDMhJq0Hi",redirectUri:"https://tijsvandenheuvel.github.io/plekjes/auth0callback",responseType:"token id_token",scope:"openid profile email",audience:"https://plekjes-api.be"}),userIsAuthenticated:!1,userEmail:null,userData:null,userToBeCreated:!1,selectedPlekollection:null,featureCollections:[],featureCollectionToEdit:null,featureCollectionToCreate:{features:[]},creatingPlekollection:!1,editingPlekollection:!1},mutations:{setUserIsAuthenticated:function(e,t){e.userIsAuthenticated=t},filterFeatureCollections:function(e,t){e.featureCollections=e.featureCollections.filter((function(e){return e.props.name!=t}))}},actions:{auth0Login:function(e){e.state.auth0.authorize()},auth0HandleAuthentication:function(e){e.state.auth0.parseHash((function(t,o){if(o&&o.accessToken&&o.idToken){var n=JSON.stringify((new Date).getTime()+1e3*o.expiresIn);localStorage.setItem("access_token",o.accessToken),localStorage.setItem("id_token",o.idToken),localStorage.setItem("expires_at",n),e.dispatch("auth0getUserEmail"),r["a"].replace("/intern"),t&&(alert("login failed"),r["a"].replace("/"),console.log(t))}}))},auth0getUserEmail:function(e){localStorage.getItem("access_token")&&e.state.auth0.client.userInfo(localStorage.getItem("access_token"),(function(t,o){o&&(e.state.userEmail=o.email)}))},auth0Logout:function(e){localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),window.location.href="https://tijs-app.eu.auth0.com/v2/logout?returnTo=https://tijsvandenheuvel.github.io/plekjes&client_id=GSTtuqSVd4zA7NvQ8qeVszNDDMhJq0Hi"}}})},e370:function(e,t,o){"use strict";o("d3b7"),o("3ca3"),o("ddb0"),o("45fc"),o("0d03"),o("ac1f"),o("5319");var n=o("6c02"),a=o("7a23");function r(e,t,o,n,r,i){var s=Object(a["z"])("Map");return Object(a["s"])(),Object(a["d"])(s)}var i={id:"mapContainer"},s={key:0,class:"leaflet-bottom"},l={class:"map-buttons"};function c(e,t,o,n,r,c){return Object(a["s"])(),Object(a["f"])("div",i,[this.$store.state.userIsAuthenticated?(Object(a["s"])(),Object(a["f"])("div",s,[Object(a["g"])("div",l,[this.$store.state.creatingPlekollection||this.$store.state.editingPlekollection?(Object(a["s"])(),Object(a["f"])("button",{key:0,class:"btn",onClick:t[0]||(t[0]=function(e){return c.save()})}," save ")):1==this.$store.state.featureCollections.length?(Object(a["s"])(),Object(a["f"])("button",{key:1,class:"btn",onClick:t[1]||(t[1]=function(e){return c.edit()})}," edit ")):(Object(a["s"])(),Object(a["f"])("button",{key:2,class:"btn",onClick:t[2]||(t[2]=function(e){return c.create()})},"+"))])])):Object(a["e"])("",!0)])}o("d81d"),o("b0c0"),o("4160"),o("159b");var u,p=o("e11e"),d=o.n(p),f=(o("6cc5"),o("20d6"),o("5fbf"),o("7c15"));delete d.a.Icon.Default.prototype._getIconUrl,d.a.Icon.Default.mergeOptions({iconRetinaUrl:o("584d"),iconUrl:o("6397"),shadowUrl:o("e2b9")});var h={data:function(){return{osm_layer:d.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),layercontrol:d.a.control.layers(),polygonMarkerOptions:{radius:2,fillColor:"green",color:"green",weight:2,opacity:.5,fillOpacity:.2},pointMarkerOptions:{radius:3,fillColor:"red",color:"red",weight:3,opacity:1,fillOpacity:.2},drawControl:null}},methods:{setupMap:function(){u=d.a.map("mapContainer",{center:[51.11,4.46],crs:d.a.CRS.EPSG3857,zoom:11,zoomControl:!0,preferCanvas:!1}),this.osm_layer.addTo(u),d.a.control.scale().addTo(u),this.layercontrol.addTo(u),this.layercontrol.addBaseLayer(this.osm_layer,"OSM layer")},addToolTip:function(e,t){e.properties&&e.properties.name&&t.bindTooltip(e.properties.name)},displayFeatures:function(e){var t,o=this;t=this.$store.state.editingPlekollection?this.drawnItems:d.a.featureGroup().addTo(u),e.features.forEach((function(e){switch(e.geometry.type){case"Point":o.$store.state.editingPlekollection?d.a.geoJSON(e,{onEachFeature:o.addToolTip}).addTo(t):d.a.geoJSON(e,{pointToLayer:function(e,t){return d.a.circleMarker(t,o.pointMarkerOptions)},onEachFeature:o.addToolTip}).addTo(t);break;case"Polygon":case"MultiPolygon":d.a.geoJSON(e,{style:o.polygonMarkerOptions,onEachFeature:o.addToolTip}).addTo(t);break;default:d.a.geoJSON(e,{onEachFeature:o.addToolTip}).addTo(t)}})),this.$store.state.editingPlekollection||this.layercontrol.addOverlay(t,e.props.name)},clearMapLayers:function(){var e=this;u.eachLayer((function(t){t._url||(u.removeLayer(t),e.layercontrol.removeLayer(t))}))},displayFeatureCollections:function(){var e=this;this.clearMapLayers(),this.$store.state.featureCollections.forEach((function(t){e.displayFeatures(t)}))},addDrawControl:function(e){var t=this;this.drawControl||(this.drawnItems=(new d.a.FeatureGroup).addTo(u),this.layercontrol.addOverlay(this.drawnItems,e),this.drawControl=new d.a.Control.Draw({edit:{featureGroup:this.drawnItems,edit:!1},draw:{marker:!0,polygon:!0,polyline:!0,circle:!1,rectangle:!1,circlemarker:!1}}),this.drawControl.addTo(u),u.on("draw:created",(function(e){var o=e.layer;o.properties={};var n=o.feature=o.feature||{};n.type="Feature",n.properties=n.properties||{};var a=prompt("Name Plekje"," ");null!=a&&" "!=a&&(n.properties["name"]=a,o.bindTooltip(n.properties["name"]),t.drawnItems.addLayer(o),t.$store.state.creatingPlekollection?t.$store.state.featureCollectionToCreate.features.push(o.toGeoJSON()):t.$store.state.editingPlekollection&&t.$store.state.featureCollectionToEdit.features.push(o.toGeoJSON()))})))},create:function(){this.$store.state.creatingPlekollection||(this.$store.state.creatingPlekollection=!0,this.addDrawControl("new plekollection"))},save:function(){var e=this;this.$store.state.editingPlekollection?f.editPlekollectionFlow((function(){e.displayFeatureCollections()})):f.saveCreatedPlekollection((function(t){t&&u.eachLayer((function(t){t._url||(u.removeLayer(t),e.layercontrol.removeLayer(t))}))})),this.drawnItems=null,this.drawControl=null,this.layercontrol=d.a.control.layers(),u.remove(),this.setupMap(),this.displayFeatureCollections()},edit:function(){this.$store.state.editingPlekollection=!0,this.$store.state.featureCollectionToEdit=this.$store.state.featureCollections[0],this.$store.state.featureCollections=[],this.displayFeatureCollections(),this.addDrawControl(this.$store.state.featureCollectionToEdit.props.name),this.displayFeatures(this.$store.state.featureCollectionToEdit)}},mounted:function(){this.setupMap(),this.$store.state.creatingPlekollection?this.addDrawControl("new plekollection"):this.$store.state.editingPlekollection?(this.addDrawControl(this.$store.state.featureCollectionToEdit.props.name),this.displayFeatures(this.$store.state.featureCollectionToEdit)):this.displayFeatureCollections()},beforeUnmount:function(){u&&u.remove()}},m=(o("658b"),o("6b0d")),g=o.n(m);const k=g()(h,[["render",c]]);var v=k,y={components:{Map:v}};const b=g()(y,[["render",r]]);var O=b,j=o("da6f"),T=[{path:"/",name:"Home",component:O},{path:"/auth0callback",component:O},{path:"/intern",name:"Intern",component:function(){return o.e("about").then(o.bind(null,"2623"))}},{path:"/extern",name:"Extern",component:function(){return o.e("about").then(o.bind(null,"5a21"))}}],C=Object(n["a"])({history:Object(n["b"])("/"),routes:T});C.beforeEach((function(e,t,o){e.matched.some((function(e){return"/auth0callback"==e.path}))&&j["a"].dispatch("auth0HandleAuthentication");var n=!1;if(localStorage.getItem("access_token")&&localStorage.getItem("id_token")&&localStorage.getItem("expires_at")){var a=JSON.parse(localStorage.getItem("expires_at"));n=(new Date).getTime()<a}j["a"].commit("setUserIsAuthenticated",n),e.matched.some((function(e){return e.meta.requiresAuth}))?n?(j["a"].commit("setUserIsAuthenticated",!0),o()):C.replace("/"):o()}));t["a"]=C}});
//# sourceMappingURL=app.d7192def.js.map